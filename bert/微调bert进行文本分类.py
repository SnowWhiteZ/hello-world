#!/usr/bin/python3
# coding: utf-8

from keras_bert import load_trained_model_from_checkpoint, Tokenizer
import codecs
import time
import json
import numpy as np
import pandas as pd
from random import choice
from keras_bert import load_trained_model_from_checkpoint, Tokenizer
from keras_bert.layers.embedding import TokenEmbedding
from keras_pos_embd.pos_embd import PositionEmbedding
from keras_layer_normalization.layer_normalization import LayerNormalization
from keras_multi_head.multi_head_attention import MultiHeadAttention
from keras_position_wise_feed_forward.feed_forward import FeedForward
from keras_bert.bert import gelu_tensorflow
import re, os
import codecs

# https://github.com/bojone/bert_in_keras/
# https://kexue.fm/archives/6736#%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB

config_path = '/home/gswyhq/data/chinese_L-12_H-768_A-12/bert_config.json'
checkpoint_path = '/home/gswyhq/data/chinese_L-12_H-768_A-12/bert_model.ckpt'
dict_path = '/home/gswyhq/data/chinese_L-12_H-768_A-12/vocab.txt'

maxlen = 100
token_dict = {}
with codecs.open(dict_path, 'r', 'utf8') as reader:
    for line in reader:
        token = line.strip()
        token_dict[token] = len(token_dict)

class OurTokenizer(Tokenizer):
    """
    Tokenizer有自己的_tokenize方法，这里重写了这个方法，是要保证tokenize之后的结果，跟原来的字符串长度等长（如果算上两个标记，那么就是等长再加2）。
    Tokenizer自带的_tokenize会自动去掉空格，然后有些字符会粘在一块输出，
    导致tokenize之后的列表不等于原来字符串的长度了，这样如果做序列标注的任务会很麻烦。
    而为了避免这种麻烦，还是自己重写一遍好了～主要就是用[unused1]来表示空格类字符，而其余的不在列表的字符用[UNK]表示，
    其中[unused*]这些标记是未经训练的（随即初始化），
    是Bert预留出来用来增量添加词汇的标记，所以我们可以用它们来指代任何新字符。
    """
    def _tokenize(self, text):
        R = []
        for c in text:
            if c in self._token_dict:
                R.append(c)
            elif self._is_space(c):
                R.append('[unused1]') # space类用未经训练的[unused1]表示
            else:
                R.append('[UNK]') # 剩余的字符是[UNK]
        return R

tokenizer = OurTokenizer(token_dict)
cut_words = tokenizer.tokenize(u'今天天气不错')
print(cut_words)

# ['[CLS]', '今', '天', '天', '气', '不', '错', '[SEP]']
# Tokenizer的输出结果:
# 默认情况下，分词后句子首位会分别加上[CLS]和[SEP]标记，其中[CLS]位置对应的输出向量是能代表整句的句向量（反正Bert是这样设计的），
# 而[SEP]则是句间的分隔符，其余部分则是单字输出（对于中文来说）。

# 语料来源：https://github.com/zhuanxuhit/nd101/tree/master/1.Intro_to_Deep_Learning/3.How_to_Do_Sentiment_Analysis/data
neg = pd.read_excel('/home/gswyhq/data/neg.xls', header=None)
pos = pd.read_excel('/home/gswyhq/data/pos.xls', header=None)

data = []

for d in neg[0]:
    data.append((d, 0))

for d in pos[0]:
    data.append((d, 1))



# 按照9:1的比例划分训练集和验证集
random_order = list(range(len(data)))
np.random.shuffle(random_order)
train_data = [data[j] for i, j in enumerate(random_order) if i % 10 != 0]
valid_data = [data[j] for i, j in enumerate(random_order) if i % 10 == 0]

# len(train_data)
# Out[4]: 18994
# len(valid_data)
# Out[5]: 2111

# 全面数据训练时间太久，为了演示减少数据量
# train_data = train_data[:2000] + train_data[-2000:]
# valid_data = valid_data[:200] + valid_data[-200:]

def seq_padding(X, padding=0):
    L = [len(x) for x in X]
    ML = max(L)
    return np.array([
        np.concatenate([x, [padding] * (ML - len(x))]) if len(x) < ML else x for x in X
    ])


class data_generator:
    def __init__(self, data, batch_size=24):
        self.data = data
        self.batch_size = batch_size
        self.steps = len(self.data) // self.batch_size
        if len(self.data) % self.batch_size != 0:
            self.steps += 1
    def __len__(self):
        return self.steps
    def __iter__(self):
        while True:
            idxs = list(range(len(self.data)))
            np.random.shuffle(idxs)
            X1, X2, Y = [], [], []
            for i in idxs:
                d = self.data[i]
                text = d[0][:maxlen]
                x1, x2 = tokenizer.encode(first=text)
                y = d[1]
                X1.append(x1)
                X2.append(x2)
                Y.append([y])
                if len(X1) == self.batch_size or i == idxs[-1]:
                    X1 = seq_padding(X1)
                    X2 = seq_padding(X2)
                    Y = seq_padding(Y)
                    yield [X1, X2], Y
                    [X1, X2, Y] = [], [], []


from keras.layers import *
from keras.models import Model, load_model
import keras.backend as K
from keras.optimizers import Adam


bert_model = load_trained_model_from_checkpoint(config_path, checkpoint_path, seq_len=None)

for l in bert_model.layers:
    l.trainable = True

x1_in = Input(shape=(None,))
x2_in = Input(shape=(None,))

x = bert_model([x1_in, x2_in])
x = Lambda(lambda x: x[:, 0])(x)
p = Dense(1, activation='sigmoid')(x)

model = Model([x1_in, x2_in], p)
model.compile(
    loss='binary_crossentropy',
    optimizer=Adam(1e-5), # 用足够小的学习率
    metrics=['accuracy']
)
model.summary()

'''
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, None)         0
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, None)         0
__________________________________________________________________________________________________
model_2 (Model)                 (None, None, 768)    101677056   input_1[0][0]
                                                                 input_2[0][0]
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 768)          0           model_2[1][0]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            769         lambda_1[0][0]
==================================================================================================
Total params: 101,677,825
Trainable params: 101,677,825
Non-trainable params: 0
__________________________________________________________________________________________________
'''

train_D = data_generator(train_data)
valid_D = data_generator(valid_data)

start_time = time.time()
model.fit_generator(
    train_D.__iter__(),
    steps_per_epoch=len(train_D),
    epochs=1,
    validation_data=valid_D.__iter__(),
    validation_steps=len(valid_D)
)
model.save('model.h5')
print('总耗时：{}'.format(time.time() - start_time))

def predict(data, model_file='/home/gswyhq/hello-world/bert/model.h5'):
    model = load_model(model_file, custom_objects={'TokenEmbedding':TokenEmbedding,
                                                 'PositionEmbedding': PositionEmbedding,
                                                 'LayerNormalization': LayerNormalization,
                                                 'MultiHeadAttention': MultiHeadAttention,
                                                 'FeedForward': FeedForward,
                                                 'gelu_tensorflow': gelu_tensorflow})
    X1, X2 = [], []
    for text in data:
        text = text[:maxlen]
        x1, x2 = tokenizer.encode(first=text)

        X1.append(x1)
        X2.append(x2)
    X1 = seq_padding(X1)
    X2 = seq_padding(X2)
    p = model.predict([X1, X2])
    # print(p)
    # array([[3.3333652e-02],
    #        [4.5858583e-04],
    #        [3.7652149e-03],
    #        [9.9127966e-01]], dtype=float32)
    return p

def main():
    data = ['我是带孩子去的.电视画面一打开就是不堪入目的镜头.怕孩子乱摁,只有把遥控器藏起来.作为五星酒店怎么可以象街头旅馆? 酒店应该反思一下.',
            '至少我没觉得好看，根本就不吸引我，没什么可笑得，有些词很深辟。书的印刷很不错，内容没介绍的好。',
            '质量不好，差评',
            '点赞，好评'
            ]
    # predict(data)


if __name__ == '__main__':
    main()

# /usr/bin/python3.6 /home/gswyhq/hello-world/bert/微调bert进行文本分类.py
# Using TensorFlow backend.
# ['[CLS]', '今', '天', '天', '气', '不', '错', '[SEP]']
# WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
# Instructions for updating:
# Colocations handled automatically by placer.
# WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
# Instructions for updating:
# Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
# 2019-07-21 08:36:45.736379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294685000 Hz
# 2019-07-21 08:36:45.736784: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2e9f180 executing computations on platform Host. Devices:
# 2019-07-21 08:36:45.736819: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
# __________________________________________________________________________________________________
# Layer (type)                    Output Shape         Param #     Connected to
# ==================================================================================================
# input_1 (InputLayer)            (None, None)         0
# __________________________________________________________________________________________________
# input_2 (InputLayer)            (None, None)         0
# __________________________________________________________________________________________________
# model_2 (Model)                 (None, None, 768)    101677056   input_1[0][0]
#                                                                  input_2[0][0]
# __________________________________________________________________________________________________
# lambda_1 (Lambda)               (None, 768)          0           model_2[1][0]
# __________________________________________________________________________________________________
# dense_1 (Dense)                 (None, 1)            769         lambda_1[0][0]
# ==================================================================================================
# Total params: 101,677,825
# Trainable params: 101,677,825
# Non-trainable params: 0
# __________________________________________________________________________________________________
# WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
# Instructions for updating:
# Use tf.cast instead.
# WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
# Instructions for updating:
# Deprecated in favor of operator or tf.math.divide.
# Epoch 1/1
#
#   1/792 [..............................] - ETA: 5:15:44 - loss: 0.8462 - acc: 0.4167
#   2/792 [..............................] - ETA: 3:47:23 - loss: 0.8453 - acc: 0.3333
#   3/792 [..............................] - ETA: 3:17:41 - loss: 0.8108 - acc: 0.4028
#   4/792 [..............................] - ETA: 3:02:48 - loss: 0.8561 - acc: 0.4167
#   5/792 [..............................] - ETA: 2:53:39 - loss: 0.8587 - acc: 0.4250
#   6/792 [..............................] - ETA: 2:47:33 - loss: 0.8684 - acc: 0.4167
#   7/792 [..............................] - ETA: 2:43:14 - loss: 0.8337 - acc: 0.4464
#   8/792 [..............................] - ETA: 2:39:51 - loss: 0.7961 - acc: 0.4740
#   9/792 [..............................] - ETA: 2:37:13 - loss: 0.7748 - acc: 0.4907
#  10/792 [..............................] - ETA: 2:35:10 - loss: 0.7521 - acc: 0.5167
#  11/792 [..............................] - ETA: 2:33:24 - loss: 0.7445 - acc: 0.5227
#  12/792 [..............................] - ETA: 2:31:57 - loss: 0.7400 - acc: 0.5243
#  13/792 [..............................] - ETA: 2:30:44 - loss: 0.7347 - acc: 0.5224
#  14/792 [..............................] - ETA: 2:29:41 - loss: 0.7206 - acc: 0.5357
#  15/792 [..............................] - ETA: 2:28:43 - loss: 0.7079 - acc: 0.5528
#  16/792 [..............................] - ETA: 2:27:48 - loss: 0.6961 - acc: 0.5651
#  17/792 [..............................] - ETA: 2:27:02 - loss: 0.6795 - acc: 0.5809
#  18/792 [..............................] - ETA: 2:26:17 - loss: 0.6764 - acc: 0.5856
#  19/792 [..............................] - ETA: 2:25:37 - loss: 0.6695 - acc: 0.5943
#  20/792 [..............................] - ETA: 2:25:02 - loss: 0.6648 - acc: 0.6000
#  21/792 [..............................] - ETA: 2:24:26 - loss: 0.6588 - acc: 0.6091
#  22/792 [..............................] - ETA: 2:23:54 - loss: 0.6522 - acc: 0.6155
#  23/792 [..............................] - ETA: 2:23:19 - loss: 0.6397 - acc: 0.6268
#  24/792 [..............................] - ETA: 2:22:49 - loss: 0.6272 - acc: 0.6372
#  25/792 [..............................] - ETA: 2:22:21 - loss: 0.6131 - acc: 0.6483
#  26/792 [..............................] - ETA: 2:21:51 - loss: 0.6005 - acc: 0.6603
#  27/792 [>.............................] - ETA: 2:21:24 - loss: 0.5936 - acc: 0.6667
#  28/792 [>.............................] - ETA: 2:20:57 - loss: 0.5835 - acc: 0.6741
#  29/792 [>.............................] - ETA: 2:20:30 - loss: 0.5762 - acc: 0.6810
#  30/792 [>.............................] - ETA: 2:20:05 - loss: 0.5737 - acc: 0.6861
#  31/792 [>.............................] - ETA: 2:19:40 - loss: 0.5660 - acc: 0.6909
#  32/792 [>.............................] - ETA: 2:19:17 - loss: 0.5596 - acc: 0.6966
#  33/792 [>.............................] - ETA: 2:18:55 - loss: 0.5505 - acc: 0.7058
#  34/792 [>.............................] - ETA: 2:18:33 - loss: 0.5399 - acc: 0.7132
#  35/792 [>.............................] - ETA: 2:18:15 - loss: 0.5329 - acc: 0.7179
#  36/792 [>.............................] - ETA: 2:17:54 - loss: 0.5263 - acc: 0.7234
#  37/792 [>.............................] - ETA: 2:17:34 - loss: 0.5178 - acc: 0.7286
#  38/792 [>.............................] - ETA: 2:17:15 - loss: 0.5151 - acc: 0.7303
#  39/792 [>.............................] - ETA: 2:16:55 - loss: 0.5103 - acc: 0.7329
#  40/792 [>.............................] - ETA: 2:16:37 - loss: 0.5019 - acc: 0.7365
#  41/792 [>.............................] - ETA: 2:16:17 - loss: 0.5011 - acc: 0.7378
#  42/792 [>.............................] - ETA: 2:16:01 - loss: 0.4932 - acc: 0.7431
#  43/792 [>.............................] - ETA: 2:15:43 - loss: 0.4905 - acc: 0.7461
#  44/792 [>.............................] - ETA: 2:15:25 - loss: 0.4814 - acc: 0.7519
#  45/792 [>.............................] - ETA: 2:15:08 - loss: 0.4758 - acc: 0.7565
#  46/792 [>.............................] - ETA: 2:14:51 - loss: 0.4676 - acc: 0.7609
#  47/792 [>.............................] - ETA: 2:14:36 - loss: 0.4636 - acc: 0.7624
#  48/792 [>.............................] - ETA: 2:14:22 - loss: 0.4594 - acc: 0.7639
#  49/792 [>.............................] - ETA: 2:14:05 - loss: 0.4584 - acc: 0.7645
#  50/792 [>.............................] - ETA: 2:13:49 - loss: 0.4572 - acc: 0.7658
#  51/792 [>.............................] - ETA: 2:13:33 - loss: 0.4580 - acc: 0.7663
#  52/792 [>.............................] - ETA: 2:13:17 - loss: 0.4536 - acc: 0.7684
#  53/792 [=>............................] - ETA: 2:13:03 - loss: 0.4498 - acc: 0.7704
#  54/792 [=>............................] - ETA: 2:12:49 - loss: 0.4474 - acc: 0.7724
#  55/792 [=>............................] - ETA: 2:12:35 - loss: 0.4413 - acc: 0.7758
#  56/792 [=>............................] - ETA: 2:12:20 - loss: 0.4397 - acc: 0.7760
#  57/792 [=>............................] - ETA: 2:12:05 - loss: 0.4394 - acc: 0.7770
#  58/792 [=>............................] - ETA: 2:11:52 - loss: 0.4359 - acc: 0.7795
#  59/792 [=>............................] - ETA: 2:11:39 - loss: 0.4343 - acc: 0.7818
#  60/792 [=>............................] - ETA: 2:11:25 - loss: 0.4282 - acc: 0.7854
#  61/792 [=>............................] - ETA: 2:11:11 - loss: 0.4243 - acc: 0.7883
#  62/792 [=>............................] - ETA: 2:10:57 - loss: 0.4245 - acc: 0.7890
#  63/792 [=>............................] - ETA: 2:10:43 - loss: 0.4232 - acc: 0.7897
#  64/792 [=>............................] - ETA: 2:10:29 - loss: 0.4223 - acc: 0.7910
#  65/792 [=>............................] - ETA: 2:10:15 - loss: 0.4175 - acc: 0.7936
#  66/792 [=>............................] - ETA: 2:10:02 - loss: 0.4174 - acc: 0.7942
#  67/792 [=>............................] - ETA: 2:09:49 - loss: 0.4145 - acc: 0.7948
#  68/792 [=>............................] - ETA: 2:09:35 - loss: 0.4108 - acc: 0.7972
#  69/792 [=>............................] - ETA: 2:09:22 - loss: 0.4076 - acc: 0.7995
#  70/792 [=>............................] - ETA: 2:09:08 - loss: 0.4048 - acc: 0.8006
#  71/792 [=>............................] - ETA: 2:08:55 - loss: 0.4015 - acc: 0.8028
#  72/792 [=>............................] - ETA: 2:08:42 - loss: 0.3998 - acc: 0.8044
#  73/792 [=>............................] - ETA: 2:08:29 - loss: 0.3974 - acc: 0.8059
#  74/792 [=>............................] - ETA: 2:08:15 - loss: 0.3945 - acc: 0.8074
#  75/792 [=>............................] - ETA: 2:08:02 - loss: 0.3914 - acc: 0.8094
#  76/792 [=>............................] - ETA: 2:07:49 - loss: 0.3883 - acc: 0.8109
#  77/792 [=>............................] - ETA: 2:07:37 - loss: 0.3844 - acc: 0.8133
#  78/792 [=>............................] - ETA: 2:07:24 - loss: 0.3829 - acc: 0.8141
#  79/792 [=>............................] - ETA: 2:07:11 - loss: 0.3813 - acc: 0.8154
#  80/792 [==>...........................] - ETA: 2:06:59 - loss: 0.3809 - acc: 0.8156
#  81/792 [==>...........................] - ETA: 2:06:47 - loss: 0.3809 - acc: 0.8169
#  82/792 [==>...........................] - ETA: 2:06:36 - loss: 0.3809 - acc: 0.8176
#  83/792 [==>...........................] - ETA: 2:06:23 - loss: 0.3828 - acc: 0.8178
#  84/792 [==>...........................] - ETA: 2:06:13 - loss: 0.3812 - acc: 0.8189
#  85/792 [==>...........................] - ETA: 2:06:01 - loss: 0.3781 - acc: 0.8206
#  86/792 [==>...........................] - ETA: 2:05:49 - loss: 0.3745 - acc: 0.8227
#  87/792 [==>...........................] - ETA: 2:05:37 - loss: 0.3743 - acc: 0.8233
#  88/792 [==>...........................] - ETA: 2:05:26 - loss: 0.3711 - acc: 0.8253
#  89/792 [==>...........................] - ETA: 2:05:14 - loss: 0.3688 - acc: 0.8268
#  90/792 [==>...........................] - ETA: 2:05:02 - loss: 0.3665 - acc: 0.8282
#  91/792 [==>...........................] - ETA: 2:04:49 - loss: 0.3664 - acc: 0.8288
#  92/792 [==>...........................] - ETA: 2:04:37 - loss: 0.3636 - acc: 0.8302
#  93/792 [==>...........................] - ETA: 2:04:24 - loss: 0.3608 - acc: 0.8315
#  94/792 [==>...........................] - ETA: 2:04:12 - loss: 0.3611 - acc: 0.8311
#  95/792 [==>...........................] - ETA: 2:04:00 - loss: 0.3591 - acc: 0.8320
#  96/792 [==>...........................] - ETA: 2:03:48 - loss: 0.3593 - acc: 0.8316
#  97/792 [==>...........................] - ETA: 2:03:36 - loss: 0.3583 - acc: 0.8320
#  98/792 [==>...........................] - ETA: 2:03:26 - loss: 0.3562 - acc: 0.8333
#  99/792 [==>...........................] - ETA: 2:03:15 - loss: 0.3579 - acc: 0.8325
# 100/792 [==>...........................] - ETA: 2:03:04 - loss: 0.3567 - acc: 0.8333
# 101/792 [==>...........................] - ETA: 2:02:53 - loss: 0.3572 - acc: 0.8333
# 102/792 [==>...........................] - ETA: 2:02:40 - loss: 0.3556 - acc: 0.8342
# 103/792 [==>...........................] - ETA: 2:02:29 - loss: 0.3540 - acc: 0.8350
# 104/792 [==>...........................] - ETA: 2:02:18 - loss: 0.3512 - acc: 0.8365
# 105/792 [==>...........................] - ETA: 2:02:07 - loss: 0.3513 - acc: 0.8369
# 106/792 [===>..........................] - ETA: 2:01:57 - loss: 0.3501 - acc: 0.8373
# 107/792 [===>..........................] - ETA: 2:01:45 - loss: 0.3500 - acc: 0.8372
# 108/792 [===>..........................] - ETA: 2:01:33 - loss: 0.3490 - acc: 0.8380
# 109/792 [===>..........................] - ETA: 2:01:22 - loss: 0.3465 - acc: 0.8394
# 110/792 [===>..........................] - ETA: 2:01:10 - loss: 0.3455 - acc: 0.8398
# 111/792 [===>..........................] - ETA: 2:00:58 - loss: 0.3444 - acc: 0.8405
# 112/792 [===>..........................] - ETA: 2:00:47 - loss: 0.3432 - acc: 0.8411
# 113/792 [===>..........................] - ETA: 2:00:36 - loss: 0.3440 - acc: 0.8414
# 114/792 [===>..........................] - ETA: 2:00:25 - loss: 0.3422 - acc: 0.8421
# 115/792 [===>..........................] - ETA: 2:00:18 - loss: 0.3414 - acc: 0.8424
# 116/792 [===>..........................] - ETA: 2:00:09 - loss: 0.3399 - acc: 0.8434
# 117/792 [===>..........................] - ETA: 1:59:59 - loss: 0.3387 - acc: 0.8440
# 118/792 [===>..........................] - ETA: 1:59:50 - loss: 0.3392 - acc: 0.8443
# 119/792 [===>..........................] - ETA: 1:59:39 - loss: 0.3386 - acc: 0.8449
# 120/792 [===>..........................] - ETA: 1:59:27 - loss: 0.3389 - acc: 0.8444
# 121/792 [===>..........................] - ETA: 1:59:16 - loss: 0.3415 - acc: 0.8440
# 122/792 [===>..........................] - ETA: 1:59:06 - loss: 0.3419 - acc: 0.8436
# 123/792 [===>..........................] - ETA: 1:58:54 - loss: 0.3410 - acc: 0.8438
# 124/792 [===>..........................] - ETA: 1:58:43 - loss: 0.3406 - acc: 0.8441
# 125/792 [===>..........................] - ETA: 1:58:32 - loss: 0.3399 - acc: 0.8447
# 126/792 [===>..........................] - ETA: 1:58:21 - loss: 0.3389 - acc: 0.8452
# 127/792 [===>..........................] - ETA: 1:58:11 - loss: 0.3383 - acc: 0.8458
# 128/792 [===>..........................] - ETA: 1:58:01 - loss: 0.3371 - acc: 0.8467
# 129/792 [===>..........................] - ETA: 1:57:49 - loss: 0.3374 - acc: 0.8466
# 130/792 [===>..........................] - ETA: 1:57:37 - loss: 0.3376 - acc: 0.8468
# 131/792 [===>..........................] - ETA: 1:57:28 - loss: 0.3360 - acc: 0.8480
# 132/792 [====>.........................] - ETA: 1:57:18 - loss: 0.3353 - acc: 0.8479
# 133/792 [====>.........................] - ETA: 1:57:09 - loss: 0.3333 - acc: 0.8490
# 134/792 [====>.........................] - ETA: 1:56:58 - loss: 0.3335 - acc: 0.8486
# 135/792 [====>.........................] - ETA: 1:56:48 - loss: 0.3323 - acc: 0.8494
# 136/792 [====>.........................] - ETA: 1:56:37 - loss: 0.3324 - acc: 0.8496
# 137/792 [====>.........................] - ETA: 1:56:29 - loss: 0.3312 - acc: 0.8504
# 138/792 [====>.........................] - ETA: 1:56:20 - loss: 0.3310 - acc: 0.8502
# 139/792 [====>.........................] - ETA: 1:56:09 - loss: 0.3292 - acc: 0.8513
# 140/792 [====>.........................] - ETA: 1:55:59 - loss: 0.3296 - acc: 0.8512
# 141/792 [====>.........................] - ETA: 1:55:48 - loss: 0.3292 - acc: 0.8517
# 142/792 [====>.........................] - ETA: 1:55:39 - loss: 0.3279 - acc: 0.8527
# 143/792 [====>.........................] - ETA: 1:55:28 - loss: 0.3286 - acc: 0.8529
# 144/792 [====>.........................] - ETA: 1:55:18 - loss: 0.3293 - acc: 0.8530
# 145/792 [====>.........................] - ETA: 1:55:08 - loss: 0.3280 - acc: 0.8537
# 146/792 [====>.........................] - ETA: 1:54:59 - loss: 0.3264 - acc: 0.8547
# 147/792 [====>.........................] - ETA: 1:54:49 - loss: 0.3246 - acc: 0.8557
# 148/792 [====>.........................] - ETA: 1:54:39 - loss: 0.3234 - acc: 0.8561
# 149/792 [====>.........................] - ETA: 1:54:28 - loss: 0.3239 - acc: 0.8557
# 150/792 [====>.........................] - ETA: 1:54:17 - loss: 0.3242 - acc: 0.8553
# 151/792 [====>.........................] - ETA: 1:54:06 - loss: 0.3243 - acc: 0.8557
# 152/792 [====>.........................] - ETA: 1:53:57 - loss: 0.3238 - acc: 0.8561
# 153/792 [====>.........................] - ETA: 1:53:46 - loss: 0.3227 - acc: 0.8565
# 154/792 [====>.........................] - ETA: 1:53:36 - loss: 0.3211 - acc: 0.8571
# 155/792 [====>.........................] - ETA: 1:53:26 - loss: 0.3203 - acc: 0.8578
# 156/792 [====>.........................] - ETA: 1:53:16 - loss: 0.3218 - acc: 0.8576
# 157/792 [====>.........................] - ETA: 1:53:05 - loss: 0.3206 - acc: 0.8583
# 158/792 [====>.........................] - ETA: 1:52:54 - loss: 0.3197 - acc: 0.8586
# 159/792 [=====>........................] - ETA: 1:52:42 - loss: 0.3198 - acc: 0.8582
# 160/792 [=====>........................] - ETA: 1:52:32 - loss: 0.3190 - acc: 0.8586
# 161/792 [=====>........................] - ETA: 1:52:22 - loss: 0.3190 - acc: 0.8590
# 162/792 [=====>........................] - ETA: 1:52:11 - loss: 0.3182 - acc: 0.8593
# 163/792 [=====>........................] - ETA: 1:52:03 - loss: 0.3178 - acc: 0.8597
# 164/792 [=====>........................] - ETA: 1:51:51 - loss: 0.3189 - acc: 0.8592
# 165/792 [=====>........................] - ETA: 1:51:39 - loss: 0.3186 - acc: 0.8593
# 166/792 [=====>........................] - ETA: 1:51:29 - loss: 0.3183 - acc: 0.8594
# 167/792 [=====>........................] - ETA: 1:51:18 - loss: 0.3196 - acc: 0.8590
# 168/792 [=====>........................] - ETA: 1:51:08 - loss: 0.3195 - acc: 0.8589
# 169/792 [=====>........................] - ETA: 1:50:59 - loss: 0.3188 - acc: 0.8592
# 170/792 [=====>........................] - ETA: 1:50:48 - loss: 0.3191 - acc: 0.8596
# 171/792 [=====>........................] - ETA: 1:50:38 - loss: 0.3202 - acc: 0.8594
# 172/792 [=====>........................] - ETA: 1:50:30 - loss: 0.3195 - acc: 0.8597
# 173/792 [=====>........................] - ETA: 1:50:20 - loss: 0.3193 - acc: 0.8598
# 174/792 [=====>........................] - ETA: 1:50:10 - loss: 0.3185 - acc: 0.8602
# 175/792 [=====>........................] - ETA: 1:49:59 - loss: 0.3185 - acc: 0.8607
# 176/792 [=====>........................] - ETA: 1:49:49 - loss: 0.3182 - acc: 0.8608
# 177/792 [=====>........................] - ETA: 1:49:41 - loss: 0.3182 - acc: 0.8611
# 178/792 [=====>........................] - ETA: 1:49:31 - loss: 0.3172 - acc: 0.8617
# 179/792 [=====>........................] - ETA: 1:49:22 - loss: 0.3166 - acc: 0.8617
# 180/792 [=====>........................] - ETA: 1:49:13 - loss: 0.3153 - acc: 0.8625
# 181/792 [=====>........................] - ETA: 1:49:03 - loss: 0.3143 - acc: 0.8630
# 182/792 [=====>........................] - ETA: 1:48:52 - loss: 0.3136 - acc: 0.8631
# 183/792 [=====>........................] - ETA: 1:48:42 - loss: 0.3122 - acc: 0.8638
# 184/792 [=====>........................] - ETA: 1:48:30 - loss: 0.3112 - acc: 0.8646
# 185/792 [======>.......................] - ETA: 1:48:19 - loss: 0.3120 - acc: 0.8642
# 186/792 [======>.......................] - ETA: 1:48:08 - loss: 0.3110 - acc: 0.8647
# 187/792 [======>.......................] - ETA: 1:47:59 - loss: 0.3098 - acc: 0.8654
# 188/792 [======>.......................] - ETA: 1:47:48 - loss: 0.3094 - acc: 0.8657
# 189/792 [======>.......................] - ETA: 1:47:37 - loss: 0.3088 - acc: 0.8662
# 190/792 [======>.......................] - ETA: 1:47:26 - loss: 0.3091 - acc: 0.8662
# 191/792 [======>.......................] - ETA: 1:47:16 - loss: 0.3089 - acc: 0.8663
# 192/792 [======>.......................] - ETA: 1:47:05 - loss: 0.3086 - acc: 0.8665
# 193/792 [======>.......................] - ETA: 1:46:54 - loss: 0.3081 - acc: 0.8668
# 194/792 [======>.......................] - ETA: 1:46:43 - loss: 0.3078 - acc: 0.8673
# 195/792 [======>.......................] - ETA: 1:46:31 - loss: 0.3076 - acc: 0.8671
# 196/792 [======>.......................] - ETA: 1:46:20 - loss: 0.3071 - acc: 0.8676
# 197/792 [======>.......................] - ETA: 1:46:08 - loss: 0.3069 - acc: 0.8678
# 198/792 [======>.......................] - ETA: 1:45:57 - loss: 0.3065 - acc: 0.8683
# 199/792 [======>.......................] - ETA: 1:45:45 - loss: 0.3054 - acc: 0.8687
# 200/792 [======>.......................] - ETA: 1:45:33 - loss: 0.3049 - acc: 0.8690
# 201/792 [======>.......................] - ETA: 1:45:22 - loss: 0.3042 - acc: 0.8694
# 202/792 [======>.......................] - ETA: 1:45:10 - loss: 0.3050 - acc: 0.8692
# 203/792 [======>.......................] - ETA: 1:44:59 - loss: 0.3043 - acc: 0.8695
# 204/792 [======>.......................] - ETA: 1:44:47 - loss: 0.3039 - acc: 0.8697
# 205/792 [======>.......................] - ETA: 1:44:36 - loss: 0.3028 - acc: 0.8703
# 206/792 [======>.......................] - ETA: 1:44:24 - loss: 0.3032 - acc: 0.8701
# 207/792 [======>.......................] - ETA: 1:44:13 - loss: 0.3032 - acc: 0.8700
# 208/792 [======>.......................] - ETA: 1:44:01 - loss: 0.3030 - acc: 0.8704
# 209/792 [======>.......................] - ETA: 1:43:50 - loss: 0.3033 - acc: 0.8700
# 210/792 [======>.......................] - ETA: 1:43:38 - loss: 0.3028 - acc: 0.8702
# 211/792 [======>.......................] - ETA: 1:43:27 - loss: 0.3026 - acc: 0.8703
# 212/792 [=======>......................] - ETA: 1:43:15 - loss: 0.3021 - acc: 0.8705
# 213/792 [=======>......................] - ETA: 1:43:04 - loss: 0.3010 - acc: 0.8711
# 214/792 [=======>......................] - ETA: 1:42:53 - loss: 0.3009 - acc: 0.8711
# 215/792 [=======>......................] - ETA: 1:42:42 - loss: 0.3012 - acc: 0.8709
# 216/792 [=======>......................] - ETA: 1:42:31 - loss: 0.3006 - acc: 0.8713
# 217/792 [=======>......................] - ETA: 1:42:19 - loss: 0.2996 - acc: 0.8719
# 218/792 [=======>......................] - ETA: 1:42:08 - loss: 0.2993 - acc: 0.8718
# 219/792 [=======>......................] - ETA: 1:41:57 - loss: 0.2983 - acc: 0.8723
# 220/792 [=======>......................] - ETA: 1:41:46 - loss: 0.2981 - acc: 0.8725
# 221/792 [=======>......................] - ETA: 1:41:35 - loss: 0.2972 - acc: 0.8727
# 222/792 [=======>......................] - ETA: 1:41:23 - loss: 0.2969 - acc: 0.8729
# 223/792 [=======>......................] - ETA: 1:41:12 - loss: 0.2958 - acc: 0.8735
# 224/792 [=======>......................] - ETA: 1:41:01 - loss: 0.2947 - acc: 0.8741
# 225/792 [=======>......................] - ETA: 1:40:50 - loss: 0.2942 - acc: 0.8743
# 226/792 [=======>......................] - ETA: 1:40:39 - loss: 0.2945 - acc: 0.8743
# 227/792 [=======>......................] - ETA: 1:40:28 - loss: 0.2951 - acc: 0.8739
# 228/792 [=======>......................] - ETA: 1:40:17 - loss: 0.2949 - acc: 0.8741
# 229/792 [=======>......................] - ETA: 1:40:06 - loss: 0.2947 - acc: 0.8745
# 230/792 [=======>......................] - ETA: 1:39:55 - loss: 0.2948 - acc: 0.8743
# 231/792 [=======>......................] - ETA: 1:39:44 - loss: 0.2946 - acc: 0.8745
# 232/792 [=======>......................] - ETA: 1:39:33 - loss: 0.2947 - acc: 0.8741
# 233/792 [=======>......................] - ETA: 1:39:22 - loss: 0.2953 - acc: 0.8741
# 234/792 [=======>......................] - ETA: 1:39:11 - loss: 0.2953 - acc: 0.8741
# 235/792 [=======>......................] - ETA: 1:39:00 - loss: 0.2952 - acc: 0.8741
# 236/792 [=======>......................] - ETA: 1:38:49 - loss: 0.2947 - acc: 0.8745
# 237/792 [=======>......................] - ETA: 1:38:38 - loss: 0.2954 - acc: 0.8746
# 238/792 [========>.....................] - ETA: 1:38:27 - loss: 0.2955 - acc: 0.8745
# 239/792 [========>.....................] - ETA: 1:38:16 - loss: 0.2955 - acc: 0.8743
# 240/792 [========>.....................] - ETA: 1:38:05 - loss: 0.2956 - acc: 0.8745
# 241/792 [========>.....................] - ETA: 1:37:54 - loss: 0.2955 - acc: 0.8745
# 242/792 [========>.....................] - ETA: 1:37:43 - loss: 0.2965 - acc: 0.8740
# 243/792 [========>.....................] - ETA: 1:37:32 - loss: 0.2960 - acc: 0.8741
# 244/792 [========>.....................] - ETA: 1:37:21 - loss: 0.2959 - acc: 0.8745
# 245/792 [========>.....................] - ETA: 1:37:10 - loss: 0.2953 - acc: 0.8747
# 246/792 [========>.....................] - ETA: 1:37:00 - loss: 0.2950 - acc: 0.8748
# 247/792 [========>.....................] - ETA: 1:36:49 - loss: 0.2945 - acc: 0.8752
# 248/792 [========>.....................] - ETA: 1:36:38 - loss: 0.2944 - acc: 0.8752
# 249/792 [========>.....................] - ETA: 1:36:27 - loss: 0.2937 - acc: 0.8755
# 250/792 [========>.....................] - ETA: 1:36:16 - loss: 0.2935 - acc: 0.8755
# 251/792 [========>.....................] - ETA: 1:36:05 - loss: 0.2928 - acc: 0.8758
# 252/792 [========>.....................] - ETA: 1:35:55 - loss: 0.2921 - acc: 0.8762
# 253/792 [========>.....................] - ETA: 1:35:45 - loss: 0.2911 - acc: 0.8766
# 254/792 [========>.....................] - ETA: 1:35:34 - loss: 0.2907 - acc: 0.8768
# 255/792 [========>.....................] - ETA: 1:35:24 - loss: 0.2897 - acc: 0.8773
# 256/792 [========>.....................] - ETA: 1:35:13 - loss: 0.2902 - acc: 0.8771
# 257/792 [========>.....................] - ETA: 1:35:03 - loss: 0.2904 - acc: 0.8771
# 258/792 [========>.....................] - ETA: 1:34:52 - loss: 0.2902 - acc: 0.8774
# 259/792 [========>.....................] - ETA: 1:34:41 - loss: 0.2901 - acc: 0.8774
# 260/792 [========>.....................] - ETA: 1:34:31 - loss: 0.2899 - acc: 0.8777
# 261/792 [========>.....................] - ETA: 1:34:20 - loss: 0.2891 - acc: 0.8780
# 262/792 [========>.....................] - ETA: 1:34:09 - loss: 0.2883 - acc: 0.8785
# 263/792 [========>.....................] - ETA: 1:33:58 - loss: 0.2878 - acc: 0.8788
# 264/792 [=========>....................] - ETA: 1:33:47 - loss: 0.2876 - acc: 0.8788
# 265/792 [=========>....................] - ETA: 1:33:36 - loss: 0.2877 - acc: 0.8791
# 266/792 [=========>....................] - ETA: 1:33:25 - loss: 0.2875 - acc: 0.8792
# 267/792 [=========>....................] - ETA: 1:33:14 - loss: 0.2868 - acc: 0.8795
# 268/792 [=========>....................] - ETA: 1:33:04 - loss: 0.2868 - acc: 0.8795
# 269/792 [=========>....................] - ETA: 1:32:53 - loss: 0.2860 - acc: 0.8800
# 270/792 [=========>....................] - ETA: 1:32:42 - loss: 0.2860 - acc: 0.8802
# 271/792 [=========>....................] - ETA: 1:32:31 - loss: 0.2851 - acc: 0.8807
# 272/792 [=========>....................] - ETA: 1:32:20 - loss: 0.2844 - acc: 0.8810
# 273/792 [=========>....................] - ETA: 1:32:09 - loss: 0.2852 - acc: 0.8810
# 274/792 [=========>....................] - ETA: 1:31:59 - loss: 0.2849 - acc: 0.8812
# 275/792 [=========>....................] - ETA: 1:31:48 - loss: 0.2853 - acc: 0.8814
# 276/792 [=========>....................] - ETA: 1:31:37 - loss: 0.2845 - acc: 0.8818
# 277/792 [=========>....................] - ETA: 1:31:26 - loss: 0.2850 - acc: 0.8816
# 278/792 [=========>....................] - ETA: 1:31:15 - loss: 0.2842 - acc: 0.8820
# 279/792 [=========>....................] - ETA: 1:31:04 - loss: 0.2837 - acc: 0.8822
# 280/792 [=========>....................] - ETA: 1:30:53 - loss: 0.2834 - acc: 0.8823
# 281/792 [=========>....................] - ETA: 1:30:43 - loss: 0.2838 - acc: 0.8823
# 282/792 [=========>....................] - ETA: 1:30:32 - loss: 0.2837 - acc: 0.8822
# 283/792 [=========>....................] - ETA: 1:30:22 - loss: 0.2837 - acc: 0.8824
# 284/792 [=========>....................] - ETA: 1:30:11 - loss: 0.2832 - acc: 0.8825
# 285/792 [=========>....................] - ETA: 1:30:01 - loss: 0.2830 - acc: 0.8826
# 286/792 [=========>....................] - ETA: 1:29:50 - loss: 0.2824 - acc: 0.8830
# 287/792 [=========>....................] - ETA: 1:29:40 - loss: 0.2823 - acc: 0.8831
# 288/792 [=========>....................] - ETA: 1:29:29 - loss: 0.2817 - acc: 0.8835
# 289/792 [=========>....................] - ETA: 1:29:18 - loss: 0.2809 - acc: 0.8839
# 290/792 [=========>....................] - ETA: 1:29:08 - loss: 0.2805 - acc: 0.8842
# 291/792 [==========>...................] - ETA: 1:28:57 - loss: 0.2798 - acc: 0.8845
# 292/792 [==========>...................] - ETA: 1:28:46 - loss: 0.2798 - acc: 0.8846
# 293/792 [==========>...................] - ETA: 1:28:36 - loss: 0.2791 - acc: 0.8850
# 294/792 [==========>...................] - ETA: 1:28:25 - loss: 0.2788 - acc: 0.8851
# 295/792 [==========>...................] - ETA: 1:28:14 - loss: 0.2792 - acc: 0.8850
# 296/792 [==========>...................] - ETA: 1:28:04 - loss: 0.2795 - acc: 0.8849
# 297/792 [==========>...................] - ETA: 1:27:53 - loss: 0.2790 - acc: 0.8850
# 298/792 [==========>...................] - ETA: 1:27:42 - loss: 0.2786 - acc: 0.8851
# 299/792 [==========>...................] - ETA: 1:27:32 - loss: 0.2789 - acc: 0.8849
# 300/792 [==========>...................] - ETA: 1:27:21 - loss: 0.2803 - acc: 0.8843
# 301/792 [==========>...................] - ETA: 1:27:10 - loss: 0.2807 - acc: 0.8843
# 302/792 [==========>...................] - ETA: 1:27:00 - loss: 0.2810 - acc: 0.8840
# 303/792 [==========>...................] - ETA: 1:26:49 - loss: 0.2808 - acc: 0.8842
# 304/792 [==========>...................] - ETA: 1:26:39 - loss: 0.2806 - acc: 0.8843
# 305/792 [==========>...................] - ETA: 1:26:28 - loss: 0.2808 - acc: 0.8843
# 306/792 [==========>...................] - ETA: 1:26:18 - loss: 0.2803 - acc: 0.8844
# 307/792 [==========>...................] - ETA: 1:26:07 - loss: 0.2811 - acc: 0.8841
# 308/792 [==========>...................] - ETA: 1:25:56 - loss: 0.2812 - acc: 0.8842
# 309/792 [==========>...................] - ETA: 1:25:46 - loss: 0.2810 - acc: 0.8843
# 310/792 [==========>...................] - ETA: 1:25:35 - loss: 0.2810 - acc: 0.8843
# 311/792 [==========>...................] - ETA: 1:25:25 - loss: 0.2812 - acc: 0.8844
# 312/792 [==========>...................] - ETA: 1:25:14 - loss: 0.2813 - acc: 0.8842
# 313/792 [==========>...................] - ETA: 1:25:04 - loss: 0.2808 - acc: 0.8846
# 314/792 [==========>...................] - ETA: 1:24:53 - loss: 0.2808 - acc: 0.8846
# 315/792 [==========>...................] - ETA: 1:24:42 - loss: 0.2802 - acc: 0.8849
# 316/792 [==========>...................] - ETA: 1:24:32 - loss: 0.2801 - acc: 0.8850
# 317/792 [===========>..................] - ETA: 1:24:21 - loss: 0.2804 - acc: 0.8851
# 318/792 [===========>..................] - ETA: 1:24:11 - loss: 0.2803 - acc: 0.8850
# 319/792 [===========>..................] - ETA: 1:24:00 - loss: 0.2797 - acc: 0.8853
# 320/792 [===========>..................] - ETA: 1:23:49 - loss: 0.2791 - acc: 0.8857
# 321/792 [===========>..................] - ETA: 1:23:39 - loss: 0.2788 - acc: 0.8856
# 322/792 [===========>..................] - ETA: 1:23:28 - loss: 0.2783 - acc: 0.8860
# 323/792 [===========>..................] - ETA: 1:23:17 - loss: 0.2777 - acc: 0.8862
# 324/792 [===========>..................] - ETA: 1:23:07 - loss: 0.2775 - acc: 0.8863
# 325/792 [===========>..................] - ETA: 1:22:56 - loss: 0.2771 - acc: 0.8867
# 326/792 [===========>..................] - ETA: 1:22:45 - loss: 0.2766 - acc: 0.8869
# 327/792 [===========>..................] - ETA: 1:22:35 - loss: 0.2768 - acc: 0.8869
# 328/792 [===========>..................] - ETA: 1:22:24 - loss: 0.2772 - acc: 0.8867
# 329/792 [===========>..................] - ETA: 1:22:14 - loss: 0.2764 - acc: 0.8870
# 330/792 [===========>..................] - ETA: 1:22:03 - loss: 0.2758 - acc: 0.8874
# 331/792 [===========>..................] - ETA: 1:21:52 - loss: 0.2752 - acc: 0.8877
# 332/792 [===========>..................] - ETA: 1:21:42 - loss: 0.2745 - acc: 0.8881
# 333/792 [===========>..................] - ETA: 1:21:31 - loss: 0.2742 - acc: 0.8881
# 334/792 [===========>..................] - ETA: 1:21:20 - loss: 0.2735 - acc: 0.8885
# 335/792 [===========>..................] - ETA: 1:21:10 - loss: 0.2734 - acc: 0.8886
# 336/792 [===========>..................] - ETA: 1:20:59 - loss: 0.2734 - acc: 0.8884
# 337/792 [===========>..................] - ETA: 1:20:48 - loss: 0.2733 - acc: 0.8885
# 338/792 [===========>..................] - ETA: 1:20:38 - loss: 0.2730 - acc: 0.8886
# 339/792 [===========>..................] - ETA: 1:20:27 - loss: 0.2725 - acc: 0.8888
# 340/792 [===========>..................] - ETA: 1:20:16 - loss: 0.2723 - acc: 0.8888
# 341/792 [===========>..................] - ETA: 1:20:06 - loss: 0.2718 - acc: 0.8891
# 342/792 [===========>..................] - ETA: 1:19:55 - loss: 0.2714 - acc: 0.8893
# 343/792 [===========>..................] - ETA: 1:19:44 - loss: 0.2711 - acc: 0.8893
# 344/792 [============>.................] - ETA: 1:19:34 - loss: 0.2707 - acc: 0.8895
# 345/792 [============>.................] - ETA: 1:19:23 - loss: 0.2704 - acc: 0.8897
# 346/792 [============>.................] - ETA: 1:19:13 - loss: 0.2706 - acc: 0.8896
# 347/792 [============>.................] - ETA: 1:19:02 - loss: 0.2700 - acc: 0.8898
# 348/792 [============>.................] - ETA: 1:18:51 - loss: 0.2698 - acc: 0.8897
# 349/792 [============>.................] - ETA: 1:18:41 - loss: 0.2692 - acc: 0.8899
# 350/792 [============>.................] - ETA: 1:18:30 - loss: 0.2694 - acc: 0.8899
# 351/792 [============>.................] - ETA: 1:18:20 - loss: 0.2690 - acc: 0.8901
# 352/792 [============>.................] - ETA: 1:18:09 - loss: 0.2691 - acc: 0.8899
# 353/792 [============>.................] - ETA: 1:17:58 - loss: 0.2691 - acc: 0.8900
# 354/792 [============>.................] - ETA: 1:17:48 - loss: 0.2689 - acc: 0.8901
# 355/792 [============>.................] - ETA: 1:17:37 - loss: 0.2686 - acc: 0.8903
# 356/792 [============>.................] - ETA: 1:17:26 - loss: 0.2683 - acc: 0.8904
# 357/792 [============>.................] - ETA: 1:17:16 - loss: 0.2679 - acc: 0.8905
# 358/792 [============>.................] - ETA: 1:17:05 - loss: 0.2674 - acc: 0.8907
# 359/792 [============>.................] - ETA: 1:16:54 - loss: 0.2670 - acc: 0.8909
# 360/792 [============>.................] - ETA: 1:16:43 - loss: 0.2672 - acc: 0.8910
# 361/792 [============>.................] - ETA: 1:16:33 - loss: 0.2675 - acc: 0.8908
# 362/792 [============>.................] - ETA: 1:16:22 - loss: 0.2678 - acc: 0.8909
# 363/792 [============>.................] - ETA: 1:16:12 - loss: 0.2675 - acc: 0.8910
# 364/792 [============>.................] - ETA: 1:16:01 - loss: 0.2675 - acc: 0.8911
# 365/792 [============>.................] - ETA: 1:15:50 - loss: 0.2670 - acc: 0.8912
# 366/792 [============>.................] - ETA: 1:15:39 - loss: 0.2666 - acc: 0.8915
# 367/792 [============>.................] - ETA: 1:15:28 - loss: 0.2663 - acc: 0.8916
# 368/792 [============>.................] - ETA: 1:15:17 - loss: 0.2665 - acc: 0.8914
# 369/792 [============>.................] - ETA: 1:15:07 - loss: 0.2662 - acc: 0.8915
# 370/792 [=============>................] - ETA: 1:14:56 - loss: 0.2658 - acc: 0.8917
# 371/792 [=============>................] - ETA: 1:14:45 - loss: 0.2660 - acc: 0.8916
# 372/792 [=============>................] - ETA: 1:14:34 - loss: 0.2654 - acc: 0.8919
# 373/792 [=============>................] - ETA: 1:14:24 - loss: 0.2655 - acc: 0.8918
# 374/792 [=============>................] - ETA: 1:14:13 - loss: 0.2656 - acc: 0.8918
# 375/792 [=============>................] - ETA: 1:14:02 - loss: 0.2655 - acc: 0.8919
# 376/792 [=============>................] - ETA: 1:13:52 - loss: 0.2654 - acc: 0.8921
# 377/792 [=============>................] - ETA: 1:13:41 - loss: 0.2656 - acc: 0.8921
# 378/792 [=============>................] - ETA: 1:13:30 - loss: 0.2654 - acc: 0.8921
# 379/792 [=============>................] - ETA: 1:13:19 - loss: 0.2649 - acc: 0.8924
# 380/792 [=============>................] - ETA: 1:13:09 - loss: 0.2653 - acc: 0.8923
# 381/792 [=============>................] - ETA: 1:12:58 - loss: 0.2652 - acc: 0.8922
# 382/792 [=============>................] - ETA: 1:12:47 - loss: 0.2649 - acc: 0.8923
# 383/792 [=============>................] - ETA: 1:12:36 - loss: 0.2649 - acc: 0.8923
# 384/792 [=============>................] - ETA: 1:12:26 - loss: 0.2643 - acc: 0.8926
# 385/792 [=============>................] - ETA: 1:12:15 - loss: 0.2643 - acc: 0.8926
# 386/792 [=============>................] - ETA: 1:12:04 - loss: 0.2647 - acc: 0.8923
# 387/792 [=============>................] - ETA: 1:11:53 - loss: 0.2642 - acc: 0.8924
# 388/792 [=============>................] - ETA: 1:11:43 - loss: 0.2640 - acc: 0.8925
# 389/792 [=============>................] - ETA: 1:11:32 - loss: 0.2638 - acc: 0.8926
# 390/792 [=============>................] - ETA: 1:11:21 - loss: 0.2638 - acc: 0.8926
# 391/792 [=============>................] - ETA: 1:11:10 - loss: 0.2635 - acc: 0.8928
# 392/792 [=============>................] - ETA: 1:11:00 - loss: 0.2640 - acc: 0.8926
# 393/792 [=============>................] - ETA: 1:10:49 - loss: 0.2635 - acc: 0.8928
# 394/792 [=============>................] - ETA: 1:10:38 - loss: 0.2633 - acc: 0.8929
# 395/792 [=============>................] - ETA: 1:10:28 - loss: 0.2633 - acc: 0.8930
# 396/792 [==============>...............] - ETA: 1:10:17 - loss: 0.2633 - acc: 0.8930
# 397/792 [==============>...............] - ETA: 1:10:06 - loss: 0.2630 - acc: 0.8932
# 398/792 [==============>...............] - ETA: 1:09:56 - loss: 0.2631 - acc: 0.8932
# 399/792 [==============>...............] - ETA: 1:09:45 - loss: 0.2625 - acc: 0.8935
# 400/792 [==============>...............] - ETA: 1:09:34 - loss: 0.2620 - acc: 0.8938
# 401/792 [==============>...............] - ETA: 1:09:23 - loss: 0.2616 - acc: 0.8939
# 402/792 [==============>...............] - ETA: 1:09:13 - loss: 0.2613 - acc: 0.8941
# 403/792 [==============>...............] - ETA: 1:09:02 - loss: 0.2611 - acc: 0.8941
# 404/792 [==============>...............] - ETA: 1:08:51 - loss: 0.2613 - acc: 0.8941
# 405/792 [==============>...............] - ETA: 1:08:41 - loss: 0.2611 - acc: 0.8942
# 406/792 [==============>...............] - ETA: 1:08:30 - loss: 0.2607 - acc: 0.8943
# 407/792 [==============>...............] - ETA: 1:08:19 - loss: 0.2602 - acc: 0.8946
# 408/792 [==============>...............] - ETA: 1:08:09 - loss: 0.2598 - acc: 0.8948
# 409/792 [==============>...............] - ETA: 1:07:58 - loss: 0.2595 - acc: 0.8950
# 410/792 [==============>...............] - ETA: 1:07:47 - loss: 0.2597 - acc: 0.8948
# 411/792 [==============>...............] - ETA: 1:07:37 - loss: 0.2592 - acc: 0.8951
# 412/792 [==============>...............] - ETA: 1:07:26 - loss: 0.2591 - acc: 0.8951
# 413/792 [==============>...............] - ETA: 1:07:15 - loss: 0.2591 - acc: 0.8952
# 414/792 [==============>...............] - ETA: 1:07:05 - loss: 0.2587 - acc: 0.8953
# 415/792 [==============>...............] - ETA: 1:06:54 - loss: 0.2582 - acc: 0.8956
# 416/792 [==============>...............] - ETA: 1:06:43 - loss: 0.2579 - acc: 0.8958
# 417/792 [==============>...............] - ETA: 1:06:33 - loss: 0.2579 - acc: 0.8959
# 418/792 [==============>...............] - ETA: 1:06:22 - loss: 0.2582 - acc: 0.8956
# 419/792 [==============>...............] - ETA: 1:06:12 - loss: 0.2579 - acc: 0.8958
# 420/792 [==============>...............] - ETA: 1:06:01 - loss: 0.2574 - acc: 0.8960
# 421/792 [==============>...............] - ETA: 1:05:50 - loss: 0.2569 - acc: 0.8963
# 422/792 [==============>...............] - ETA: 1:05:40 - loss: 0.2566 - acc: 0.8963
# 423/792 [===============>..............] - ETA: 1:05:29 - loss: 0.2563 - acc: 0.8964
# 424/792 [===============>..............] - ETA: 1:05:19 - loss: 0.2558 - acc: 0.8966
# 425/792 [===============>..............] - ETA: 1:05:08 - loss: 0.2555 - acc: 0.8968
# 426/792 [===============>..............] - ETA: 1:04:57 - loss: 0.2561 - acc: 0.8966
# 427/792 [===============>..............] - ETA: 1:04:46 - loss: 0.2558 - acc: 0.8967
# 428/792 [===============>..............] - ETA: 1:04:36 - loss: 0.2558 - acc: 0.8966
# 429/792 [===============>..............] - ETA: 1:04:25 - loss: 0.2557 - acc: 0.8968
# 430/792 [===============>..............] - ETA: 1:04:14 - loss: 0.2556 - acc: 0.8969
# 431/792 [===============>..............] - ETA: 1:04:04 - loss: 0.2555 - acc: 0.8968
# 432/792 [===============>..............] - ETA: 1:03:53 - loss: 0.2550 - acc: 0.8971
# 433/792 [===============>..............] - ETA: 1:03:42 - loss: 0.2547 - acc: 0.8972
# 434/792 [===============>..............] - ETA: 1:03:31 - loss: 0.2543 - acc: 0.8974
# 435/792 [===============>..............] - ETA: 1:03:21 - loss: 0.2548 - acc: 0.8973
# 436/792 [===============>..............] - ETA: 1:03:10 - loss: 0.2546 - acc: 0.8974
# 437/792 [===============>..............] - ETA: 1:02:59 - loss: 0.2544 - acc: 0.8975
# 438/792 [===============>..............] - ETA: 1:02:49 - loss: 0.2542 - acc: 0.8975
# 439/792 [===============>..............] - ETA: 1:02:38 - loss: 0.2538 - acc: 0.8978
# 440/792 [===============>..............] - ETA: 1:02:27 - loss: 0.2539 - acc: 0.8978
# 441/792 [===============>..............] - ETA: 1:02:16 - loss: 0.2535 - acc: 0.8980
# 442/792 [===============>..............] - ETA: 1:02:06 - loss: 0.2537 - acc: 0.8980
# 443/792 [===============>..............] - ETA: 1:01:55 - loss: 0.2535 - acc: 0.8980
# 444/792 [===============>..............] - ETA: 1:01:44 - loss: 0.2532 - acc: 0.8981
# 445/792 [===============>..............] - ETA: 1:01:34 - loss: 0.2529 - acc: 0.8982
# 446/792 [===============>..............] - ETA: 1:01:23 - loss: 0.2530 - acc: 0.8982
# 447/792 [===============>..............] - ETA: 1:01:12 - loss: 0.2526 - acc: 0.8984
# 448/792 [===============>..............] - ETA: 1:01:02 - loss: 0.2521 - acc: 0.8986
# 449/792 [================>.............] - ETA: 1:00:51 - loss: 0.2518 - acc: 0.8988
# 450/792 [================>.............] - ETA: 1:00:40 - loss: 0.2518 - acc: 0.8987
# 451/792 [================>.............] - ETA: 1:00:30 - loss: 0.2519 - acc: 0.8987
# 452/792 [================>.............] - ETA: 1:00:19 - loss: 0.2517 - acc: 0.8989
# 453/792 [================>.............] - ETA: 1:00:09 - loss: 0.2516 - acc: 0.8988
# 454/792 [================>.............] - ETA: 59:58 - loss: 0.2515 - acc: 0.8989  
# 455/792 [================>.............] - ETA: 59:47 - loss: 0.2513 - acc: 0.8989
# 456/792 [================>.............] - ETA: 59:37 - loss: 0.2509 - acc: 0.8990
# 457/792 [================>.............] - ETA: 59:26 - loss: 0.2506 - acc: 0.8992
# 458/792 [================>.............] - ETA: 59:16 - loss: 0.2505 - acc: 0.8993
# 459/792 [================>.............] - ETA: 59:05 - loss: 0.2503 - acc: 0.8994
# 460/792 [================>.............] - ETA: 58:54 - loss: 0.2504 - acc: 0.8994
# 461/792 [================>.............] - ETA: 58:44 - loss: 0.2506 - acc: 0.8992
# 462/792 [================>.............] - ETA: 58:33 - loss: 0.2503 - acc: 0.8994
# 463/792 [================>.............] - ETA: 58:22 - loss: 0.2500 - acc: 0.8995
# 464/792 [================>.............] - ETA: 58:12 - loss: 0.2496 - acc: 0.8996
# 465/792 [================>.............] - ETA: 58:01 - loss: 0.2510 - acc: 0.8991
# 466/792 [================>.............] - ETA: 57:50 - loss: 0.2510 - acc: 0.8991
# 467/792 [================>.............] - ETA: 57:40 - loss: 0.2513 - acc: 0.8988
# 468/792 [================>.............] - ETA: 57:29 - loss: 0.2509 - acc: 0.8990
# 469/792 [================>.............] - ETA: 57:18 - loss: 0.2513 - acc: 0.8988
# 470/792 [================>.............] - ETA: 57:08 - loss: 0.2517 - acc: 0.8988
# 471/792 [================>.............] - ETA: 56:57 - loss: 0.2515 - acc: 0.8988
# 472/792 [================>.............] - ETA: 56:47 - loss: 0.2517 - acc: 0.8987
# 473/792 [================>.............] - ETA: 56:36 - loss: 0.2517 - acc: 0.8986
# 474/792 [================>.............] - ETA: 56:26 - loss: 0.2514 - acc: 0.8987
# 475/792 [================>.............] - ETA: 56:15 - loss: 0.2513 - acc: 0.8989
# 476/792 [=================>............] - ETA: 56:04 - loss: 0.2512 - acc: 0.8989
# 477/792 [=================>............] - ETA: 55:54 - loss: 0.2511 - acc: 0.8989
# 478/792 [=================>............] - ETA: 55:43 - loss: 0.2507 - acc: 0.8991
# 479/792 [=================>............] - ETA: 55:32 - loss: 0.2509 - acc: 0.8991
# 480/792 [=================>............] - ETA: 55:22 - loss: 0.2509 - acc: 0.8990
# 481/792 [=================>............] - ETA: 55:11 - loss: 0.2505 - acc: 0.8993
# 482/792 [=================>............] - ETA: 55:00 - loss: 0.2505 - acc: 0.8993
# 483/792 [=================>............] - ETA: 54:50 - loss: 0.2502 - acc: 0.8994
# 484/792 [=================>............] - ETA: 54:39 - loss: 0.2501 - acc: 0.8994
# 485/792 [=================>............] - ETA: 54:29 - loss: 0.2497 - acc: 0.8997
# 486/792 [=================>............] - ETA: 54:18 - loss: 0.2500 - acc: 0.8995
# 487/792 [=================>............] - ETA: 54:07 - loss: 0.2498 - acc: 0.8997
# 488/792 [=================>............] - ETA: 53:57 - loss: 0.2496 - acc: 0.8999
# 489/792 [=================>............] - ETA: 53:46 - loss: 0.2493 - acc: 0.9000
# 490/792 [=================>............] - ETA: 53:36 - loss: 0.2490 - acc: 0.9002
# 491/792 [=================>............] - ETA: 53:25 - loss: 0.2488 - acc: 0.9002
# 492/792 [=================>............] - ETA: 53:14 - loss: 0.2487 - acc: 0.9003
# 493/792 [=================>............] - ETA: 53:04 - loss: 0.2485 - acc: 0.9004
# 494/792 [=================>............] - ETA: 52:53 - loss: 0.2485 - acc: 0.9005
# 495/792 [=================>............] - ETA: 52:42 - loss: 0.2486 - acc: 0.9003
# 496/792 [=================>............] - ETA: 52:32 - loss: 0.2485 - acc: 0.9004
# 497/792 [=================>............] - ETA: 52:21 - loss: 0.2481 - acc: 0.9006
# 498/792 [=================>............] - ETA: 52:10 - loss: 0.2480 - acc: 0.9007
# 499/792 [=================>............] - ETA: 52:00 - loss: 0.2478 - acc: 0.9008
# 500/792 [=================>............] - ETA: 51:49 - loss: 0.2479 - acc: 0.9007
# 501/792 [=================>............] - ETA: 51:38 - loss: 0.2477 - acc: 0.9007
# 502/792 [==================>...........] - ETA: 51:27 - loss: 0.2475 - acc: 0.9007
# 503/792 [==================>...........] - ETA: 51:17 - loss: 0.2471 - acc: 0.9009
# 504/792 [==================>...........] - ETA: 51:06 - loss: 0.2469 - acc: 0.9010
# 505/792 [==================>...........] - ETA: 50:55 - loss: 0.2467 - acc: 0.9012
# 506/792 [==================>...........] - ETA: 50:45 - loss: 0.2463 - acc: 0.9014
# 507/792 [==================>...........] - ETA: 50:34 - loss: 0.2460 - acc: 0.9015
# 508/792 [==================>...........] - ETA: 50:23 - loss: 0.2456 - acc: 0.9017
# 509/792 [==================>...........] - ETA: 50:13 - loss: 0.2453 - acc: 0.9019
# 510/792 [==================>...........] - ETA: 50:02 - loss: 0.2451 - acc: 0.9020
# 511/792 [==================>...........] - ETA: 49:51 - loss: 0.2448 - acc: 0.9021
# 512/792 [==================>...........] - ETA: 49:41 - loss: 0.2445 - acc: 0.9023
# 513/792 [==================>...........] - ETA: 49:30 - loss: 0.2445 - acc: 0.9024
# 514/792 [==================>...........] - ETA: 49:19 - loss: 0.2442 - acc: 0.9025
# 515/792 [==================>...........] - ETA: 49:09 - loss: 0.2442 - acc: 0.9025
# 516/792 [==================>...........] - ETA: 48:58 - loss: 0.2439 - acc: 0.9026
# 517/792 [==================>...........] - ETA: 48:47 - loss: 0.2436 - acc: 0.9028
# 518/792 [==================>...........] - ETA: 48:37 - loss: 0.2437 - acc: 0.9028
# 519/792 [==================>...........] - ETA: 48:26 - loss: 0.2435 - acc: 0.9029
# 520/792 [==================>...........] - ETA: 48:15 - loss: 0.2431 - acc: 0.9030
# 521/792 [==================>...........] - ETA: 48:05 - loss: 0.2428 - acc: 0.9032
# 522/792 [==================>...........] - ETA: 47:54 - loss: 0.2426 - acc: 0.9033
# 523/792 [==================>...........] - ETA: 47:43 - loss: 0.2422 - acc: 0.9035
# 524/792 [==================>...........] - ETA: 47:33 - loss: 0.2419 - acc: 0.9037
# 525/792 [==================>...........] - ETA: 47:22 - loss: 0.2418 - acc: 0.9038
# 526/792 [==================>...........] - ETA: 47:12 - loss: 0.2414 - acc: 0.9040
# 527/792 [==================>...........] - ETA: 47:01 - loss: 0.2410 - acc: 0.9042
# 528/792 [===================>..........] - ETA: 46:50 - loss: 0.2411 - acc: 0.9040
# 529/792 [===================>..........] - ETA: 46:40 - loss: 0.2409 - acc: 0.9041
# 530/792 [===================>..........] - ETA: 46:29 - loss: 0.2405 - acc: 0.9042
# 531/792 [===================>..........] - ETA: 46:18 - loss: 0.2402 - acc: 0.9044
# 532/792 [===================>..........] - ETA: 46:08 - loss: 0.2402 - acc: 0.9044
# 533/792 [===================>..........] - ETA: 45:57 - loss: 0.2403 - acc: 0.9043
# 534/792 [===================>..........] - ETA: 45:46 - loss: 0.2401 - acc: 0.9043
# 535/792 [===================>..........] - ETA: 45:35 - loss: 0.2400 - acc: 0.9044
# 536/792 [===================>..........] - ETA: 45:25 - loss: 0.2396 - acc: 0.9045
# 537/792 [===================>..........] - ETA: 45:14 - loss: 0.2394 - acc: 0.9046
# 538/792 [===================>..........] - ETA: 45:04 - loss: 0.2391 - acc: 0.9047
# 539/792 [===================>..........] - ETA: 44:53 - loss: 0.2390 - acc: 0.9046
# 540/792 [===================>..........] - ETA: 44:42 - loss: 0.2388 - acc: 0.9047
# 541/792 [===================>..........] - ETA: 44:32 - loss: 0.2386 - acc: 0.9048
# 542/792 [===================>..........] - ETA: 44:21 - loss: 0.2388 - acc: 0.9046
# 543/792 [===================>..........] - ETA: 44:10 - loss: 0.2390 - acc: 0.9045
# 544/792 [===================>..........] - ETA: 44:00 - loss: 0.2387 - acc: 0.9047
# 545/792 [===================>..........] - ETA: 43:49 - loss: 0.2383 - acc: 0.9049
# 546/792 [===================>..........] - ETA: 43:38 - loss: 0.2387 - acc: 0.9047
# 547/792 [===================>..........] - ETA: 43:28 - loss: 0.2390 - acc: 0.9046
# 548/792 [===================>..........] - ETA: 43:17 - loss: 0.2389 - acc: 0.9046
# 549/792 [===================>..........] - ETA: 43:06 - loss: 0.2388 - acc: 0.9046
# 550/792 [===================>..........] - ETA: 42:56 - loss: 0.2385 - acc: 0.9046
# 551/792 [===================>..........] - ETA: 42:45 - loss: 0.2383 - acc: 0.9047
# 552/792 [===================>..........] - ETA: 42:34 - loss: 0.2382 - acc: 0.9047
# 553/792 [===================>..........] - ETA: 42:24 - loss: 0.2380 - acc: 0.9048
# 554/792 [===================>..........] - ETA: 42:13 - loss: 0.2381 - acc: 0.9049
# 555/792 [====================>.........] - ETA: 42:03 - loss: 0.2378 - acc: 0.9050
# 556/792 [====================>.........] - ETA: 41:52 - loss: 0.2375 - acc: 0.9051
# 557/792 [====================>.........] - ETA: 41:41 - loss: 0.2373 - acc: 0.9051
# 558/792 [====================>.........] - ETA: 41:31 - loss: 0.2376 - acc: 0.9052
# 559/792 [====================>.........] - ETA: 41:20 - loss: 0.2373 - acc: 0.9053
# 560/792 [====================>.........] - ETA: 41:10 - loss: 0.2370 - acc: 0.9054
# 561/792 [====================>.........] - ETA: 40:59 - loss: 0.2368 - acc: 0.9055
# 562/792 [====================>.........] - ETA: 40:48 - loss: 0.2367 - acc: 0.9055
# 563/792 [====================>.........] - ETA: 40:38 - loss: 0.2368 - acc: 0.9055
# 564/792 [====================>.........] - ETA: 40:27 - loss: 0.2372 - acc: 0.9053
# 565/792 [====================>.........] - ETA: 40:16 - loss: 0.2370 - acc: 0.9054
# 566/792 [====================>.........] - ETA: 40:06 - loss: 0.2369 - acc: 0.9054
# 567/792 [====================>.........] - ETA: 39:55 - loss: 0.2368 - acc: 0.9054
# 568/792 [====================>.........] - ETA: 39:44 - loss: 0.2369 - acc: 0.9054
# 569/792 [====================>.........] - ETA: 39:34 - loss: 0.2368 - acc: 0.9055
# 570/792 [====================>.........] - ETA: 39:23 - loss: 0.2366 - acc: 0.9056
# 571/792 [====================>.........] - ETA: 39:12 - loss: 0.2365 - acc: 0.9055
# 572/792 [====================>.........] - ETA: 39:02 - loss: 0.2363 - acc: 0.9055
# 573/792 [====================>.........] - ETA: 38:51 - loss: 0.2360 - acc: 0.9057
# 574/792 [====================>.........] - ETA: 38:40 - loss: 0.2364 - acc: 0.9056
# 575/792 [====================>.........] - ETA: 38:30 - loss: 0.2361 - acc: 0.9058
# 576/792 [====================>.........] - ETA: 38:19 - loss: 0.2358 - acc: 0.9059
# 577/792 [====================>.........] - ETA: 38:09 - loss: 0.2359 - acc: 0.9058
# 578/792 [====================>.........] - ETA: 37:59 - loss: 0.2356 - acc: 0.9059
# 579/792 [====================>.........] - ETA: 37:48 - loss: 0.2355 - acc: 0.9059
# 580/792 [====================>.........] - ETA: 37:38 - loss: 0.2353 - acc: 0.9060
# 581/792 [=====================>........] - ETA: 37:27 - loss: 0.2354 - acc: 0.9059
# 582/792 [=====================>........] - ETA: 37:16 - loss: 0.2352 - acc: 0.9059
# 583/792 [=====================>........] - ETA: 37:06 - loss: 0.2352 - acc: 0.9059
# 584/792 [=====================>........] - ETA: 36:55 - loss: 0.2350 - acc: 0.9060
# 585/792 [=====================>........] - ETA: 36:45 - loss: 0.2347 - acc: 0.9061
# 586/792 [=====================>........] - ETA: 36:34 - loss: 0.2347 - acc: 0.9061
# 587/792 [=====================>........] - ETA: 36:23 - loss: 0.2346 - acc: 0.9062
# 588/792 [=====================>........] - ETA: 36:12 - loss: 0.2343 - acc: 0.9064
# 589/792 [=====================>........] - ETA: 36:02 - loss: 0.2344 - acc: 0.9064
# 590/792 [=====================>........] - ETA: 35:51 - loss: 0.2341 - acc: 0.9066
# 591/792 [=====================>........] - ETA: 35:41 - loss: 0.2340 - acc: 0.9065
# 592/792 [=====================>........] - ETA: 35:31 - loss: 0.2337 - acc: 0.9066
# 593/792 [=====================>........] - ETA: 35:20 - loss: 0.2338 - acc: 0.9065
# 594/792 [=====================>........] - ETA: 35:10 - loss: 0.2338 - acc: 0.9066
# 595/792 [=====================>........] - ETA: 34:59 - loss: 0.2336 - acc: 0.9067
# 596/792 [=====================>........] - ETA: 34:48 - loss: 0.2338 - acc: 0.9067
# 597/792 [=====================>........] - ETA: 34:37 - loss: 0.2335 - acc: 0.9069
# 598/792 [=====================>........] - ETA: 34:27 - loss: 0.2334 - acc: 0.9070
# 599/792 [=====================>........] - ETA: 34:16 - loss: 0.2334 - acc: 0.9069
# 600/792 [=====================>........] - ETA: 34:05 - loss: 0.2335 - acc: 0.9069
# 601/792 [=====================>........] - ETA: 33:54 - loss: 0.2338 - acc: 0.9069
# 602/792 [=====================>........] - ETA: 33:44 - loss: 0.2338 - acc: 0.9068
# 603/792 [=====================>........] - ETA: 33:34 - loss: 0.2340 - acc: 0.9067
# 604/792 [=====================>........] - ETA: 33:23 - loss: 0.2342 - acc: 0.9067
# 605/792 [=====================>........] - ETA: 33:13 - loss: 0.2340 - acc: 0.9067
# 606/792 [=====================>........] - ETA: 33:02 - loss: 0.2346 - acc: 0.9067
# 607/792 [=====================>........] - ETA: 32:52 - loss: 0.2347 - acc: 0.9065
# 608/792 [======================>.......] - ETA: 32:41 - loss: 0.2344 - acc: 0.9067
# 609/792 [======================>.......] - ETA: 32:31 - loss: 0.2346 - acc: 0.9065
# 610/792 [======================>.......] - ETA: 32:20 - loss: 0.2345 - acc: 0.9066
# 611/792 [======================>.......] - ETA: 32:09 - loss: 0.2343 - acc: 0.9066
# 612/792 [======================>.......] - ETA: 31:59 - loss: 0.2345 - acc: 0.9067
# 613/792 [======================>.......] - ETA: 31:48 - loss: 0.2346 - acc: 0.9067
# 614/792 [======================>.......] - ETA: 31:37 - loss: 0.2345 - acc: 0.9067
# 615/792 [======================>.......] - ETA: 31:27 - loss: 0.2344 - acc: 0.9067
# 616/792 [======================>.......] - ETA: 31:16 - loss: 0.2341 - acc: 0.9069
# 617/792 [======================>.......] - ETA: 31:06 - loss: 0.2339 - acc: 0.9070
# 618/792 [======================>.......] - ETA: 30:55 - loss: 0.2337 - acc: 0.9071
# 619/792 [======================>.......] - ETA: 30:44 - loss: 0.2336 - acc: 0.9070
# 620/792 [======================>.......] - ETA: 30:34 - loss: 0.2335 - acc: 0.9071
# 621/792 [======================>.......] - ETA: 30:23 - loss: 0.2336 - acc: 0.9069
# 622/792 [======================>.......] - ETA: 30:13 - loss: 0.2336 - acc: 0.9070
# 623/792 [======================>.......] - ETA: 30:02 - loss: 0.2335 - acc: 0.9071
# 624/792 [======================>.......] - ETA: 29:51 - loss: 0.2333 - acc: 0.9073
# 625/792 [======================>.......] - ETA: 29:41 - loss: 0.2330 - acc: 0.9074
# 626/792 [======================>.......] - ETA: 29:30 - loss: 0.2328 - acc: 0.9075
# 627/792 [======================>.......] - ETA: 29:19 - loss: 0.2329 - acc: 0.9074
# 628/792 [======================>.......] - ETA: 29:09 - loss: 0.2328 - acc: 0.9074
# 629/792 [======================>.......] - ETA: 28:58 - loss: 0.2328 - acc: 0.9074
# 630/792 [======================>.......] - ETA: 28:48 - loss: 0.2326 - acc: 0.9075
# 631/792 [======================>.......] - ETA: 28:37 - loss: 0.2327 - acc: 0.9075
# 632/792 [======================>.......] - ETA: 28:26 - loss: 0.2327 - acc: 0.9075
# 633/792 [======================>.......] - ETA: 28:15 - loss: 0.2327 - acc: 0.9075
# 634/792 [=======================>......] - ETA: 28:05 - loss: 0.2329 - acc: 0.9075
# 635/792 [=======================>......] - ETA: 27:54 - loss: 0.2329 - acc: 0.9075
# 636/792 [=======================>......] - ETA: 27:43 - loss: 0.2327 - acc: 0.9076
# 637/792 [=======================>......] - ETA: 27:33 - loss: 0.2325 - acc: 0.9076
# 638/792 [=======================>......] - ETA: 27:22 - loss: 0.2325 - acc: 0.9077
# 639/792 [=======================>......] - ETA: 27:11 - loss: 0.2324 - acc: 0.9077
# 640/792 [=======================>......] - ETA: 27:01 - loss: 0.2321 - acc: 0.9078
# 641/792 [=======================>......] - ETA: 26:50 - loss: 0.2320 - acc: 0.9078
# 642/792 [=======================>......] - ETA: 26:40 - loss: 0.2317 - acc: 0.9079
# 643/792 [=======================>......] - ETA: 26:29 - loss: 0.2319 - acc: 0.9079
# 644/792 [=======================>......] - ETA: 26:18 - loss: 0.2322 - acc: 0.9077
# 645/792 [=======================>......] - ETA: 26:08 - loss: 0.2321 - acc: 0.9077
# 646/792 [=======================>......] - ETA: 25:57 - loss: 0.2319 - acc: 0.9078
# 647/792 [=======================>......] - ETA: 25:47 - loss: 0.2318 - acc: 0.9078
# 648/792 [=======================>......] - ETA: 25:36 - loss: 0.2315 - acc: 0.9079
# 649/792 [=======================>......] - ETA: 25:25 - loss: 0.2314 - acc: 0.9079
# 650/792 [=======================>......] - ETA: 25:15 - loss: 0.2316 - acc: 0.9078
# 651/792 [=======================>......] - ETA: 25:04 - loss: 0.2315 - acc: 0.9078
# 652/792 [=======================>......] - ETA: 24:53 - loss: 0.2313 - acc: 0.9080
# 653/792 [=======================>......] - ETA: 24:43 - loss: 0.2313 - acc: 0.9080
# 654/792 [=======================>......] - ETA: 24:32 - loss: 0.2311 - acc: 0.9081
# 655/792 [=======================>......] - ETA: 24:21 - loss: 0.2309 - acc: 0.9082
# 656/792 [=======================>......] - ETA: 24:11 - loss: 0.2309 - acc: 0.9083
# 657/792 [=======================>......] - ETA: 24:00 - loss: 0.2313 - acc: 0.9082
# 658/792 [=======================>......] - ETA: 23:49 - loss: 0.2311 - acc: 0.9083
# 659/792 [=======================>......] - ETA: 23:39 - loss: 0.2311 - acc: 0.9083
# 660/792 [========================>.....] - ETA: 23:28 - loss: 0.2310 - acc: 0.9084
# 661/792 [========================>.....] - ETA: 23:17 - loss: 0.2309 - acc: 0.9085
# 662/792 [========================>.....] - ETA: 23:07 - loss: 0.2307 - acc: 0.9086
# 663/792 [========================>.....] - ETA: 22:56 - loss: 0.2304 - acc: 0.9087
# 664/792 [========================>.....] - ETA: 22:45 - loss: 0.2303 - acc: 0.9088
# 665/792 [========================>.....] - ETA: 22:35 - loss: 0.2301 - acc: 0.9088
# 666/792 [========================>.....] - ETA: 22:24 - loss: 0.2299 - acc: 0.9090
# 667/792 [========================>.....] - ETA: 22:13 - loss: 0.2295 - acc: 0.9091
# 668/792 [========================>.....] - ETA: 22:03 - loss: 0.2293 - acc: 0.9092
# 669/792 [========================>.....] - ETA: 21:52 - loss: 0.2293 - acc: 0.9091
# 670/792 [========================>.....] - ETA: 21:41 - loss: 0.2292 - acc: 0.9091
# 671/792 [========================>.....] - ETA: 21:31 - loss: 0.2292 - acc: 0.9091
# 672/792 [========================>.....] - ETA: 21:20 - loss: 0.2291 - acc: 0.9092
# 673/792 [========================>.....] - ETA: 21:09 - loss: 0.2292 - acc: 0.9091
# 674/792 [========================>.....] - ETA: 20:59 - loss: 0.2291 - acc: 0.9091
# 675/792 [========================>.....] - ETA: 20:48 - loss: 0.2291 - acc: 0.9090
# 676/792 [========================>.....] - ETA: 20:37 - loss: 0.2289 - acc: 0.9091
# 677/792 [========================>.....] - ETA: 20:27 - loss: 0.2287 - acc: 0.9092
# 678/792 [========================>.....] - ETA: 20:16 - loss: 0.2286 - acc: 0.9092
# 679/792 [========================>.....] - ETA: 20:05 - loss: 0.2284 - acc: 0.9093
# 680/792 [========================>.....] - ETA: 19:55 - loss: 0.2281 - acc: 0.9094
# 681/792 [========================>.....] - ETA: 19:44 - loss: 0.2284 - acc: 0.9093
# 682/792 [========================>.....] - ETA: 19:33 - loss: 0.2282 - acc: 0.9094
# 683/792 [========================>.....] - ETA: 19:23 - loss: 0.2285 - acc: 0.9092
# 684/792 [========================>.....] - ETA: 19:12 - loss: 0.2283 - acc: 0.9094
# 685/792 [========================>.....] - ETA: 19:01 - loss: 0.2280 - acc: 0.9095
# 686/792 [========================>.....] - ETA: 18:51 - loss: 0.2278 - acc: 0.9096
# 687/792 [=========================>....] - ETA: 18:40 - loss: 0.2278 - acc: 0.9096
# 688/792 [=========================>....] - ETA: 18:29 - loss: 0.2275 - acc: 0.9098
# 689/792 [=========================>....] - ETA: 18:19 - loss: 0.2273 - acc: 0.9099
# 690/792 [=========================>....] - ETA: 18:08 - loss: 0.2270 - acc: 0.9100
# 691/792 [=========================>....] - ETA: 17:57 - loss: 0.2267 - acc: 0.9102
# 692/792 [=========================>....] - ETA: 17:47 - loss: 0.2266 - acc: 0.9101
# 693/792 [=========================>....] - ETA: 17:36 - loss: 0.2268 - acc: 0.9101
# 694/792 [=========================>....] - ETA: 17:25 - loss: 0.2266 - acc: 0.9101
# 695/792 [=========================>....] - ETA: 17:15 - loss: 0.2264 - acc: 0.9102
# 696/792 [=========================>....] - ETA: 17:04 - loss: 0.2261 - acc: 0.9103
# 697/792 [=========================>....] - ETA: 16:53 - loss: 0.2259 - acc: 0.9104
# 698/792 [=========================>....] - ETA: 16:43 - loss: 0.2259 - acc: 0.9104
# 699/792 [=========================>....] - ETA: 16:32 - loss: 0.2261 - acc: 0.9103
# 700/792 [=========================>....] - ETA: 16:21 - loss: 0.2262 - acc: 0.9104
# 701/792 [=========================>....] - ETA: 16:10 - loss: 0.2260 - acc: 0.9105
# 702/792 [=========================>....] - ETA: 16:00 - loss: 0.2261 - acc: 0.9104
# 703/792 [=========================>....] - ETA: 15:49 - loss: 0.2262 - acc: 0.9103
# 704/792 [=========================>....] - ETA: 15:39 - loss: 0.2264 - acc: 0.9102
# 705/792 [=========================>....] - ETA: 15:28 - loss: 0.2266 - acc: 0.9102
# 706/792 [=========================>....] - ETA: 15:17 - loss: 0.2263 - acc: 0.9103
# 707/792 [=========================>....] - ETA: 15:07 - loss: 0.2261 - acc: 0.9104
# 708/792 [=========================>....] - ETA: 14:56 - loss: 0.2264 - acc: 0.9105
# 709/792 [=========================>....] - ETA: 14:45 - loss: 0.2263 - acc: 0.9105
# 710/792 [=========================>....] - ETA: 14:34 - loss: 0.2265 - acc: 0.9104
# 711/792 [=========================>....] - ETA: 14:24 - loss: 0.2266 - acc: 0.9103
# 712/792 [=========================>....] - ETA: 14:13 - loss: 0.2266 - acc: 0.9104
# 713/792 [==========================>...] - ETA: 14:03 - loss: 0.2265 - acc: 0.9104
# 714/792 [==========================>...] - ETA: 13:52 - loss: 0.2265 - acc: 0.9104
# 715/792 [==========================>...] - ETA: 13:41 - loss: 0.2262 - acc: 0.9105
# 716/792 [==========================>...] - ETA: 13:31 - loss: 0.2259 - acc: 0.9106
# 717/792 [==========================>...] - ETA: 13:20 - loss: 0.2257 - acc: 0.9107
# 718/792 [==========================>...] - ETA: 13:09 - loss: 0.2257 - acc: 0.9106
# 719/792 [==========================>...] - ETA: 12:59 - loss: 0.2259 - acc: 0.9106
# 720/792 [==========================>...] - ETA: 12:48 - loss: 0.2256 - acc: 0.9107
# 721/792 [==========================>...] - ETA: 12:37 - loss: 0.2254 - acc: 0.9108
# 722/792 [==========================>...] - ETA: 12:27 - loss: 0.2253 - acc: 0.9109
# 723/792 [==========================>...] - ETA: 12:16 - loss: 0.2251 - acc: 0.9110
# 724/792 [==========================>...] - ETA: 12:05 - loss: 0.2249 - acc: 0.9110
# 725/792 [==========================>...] - ETA: 11:55 - loss: 0.2249 - acc: 0.9111
# 726/792 [==========================>...] - ETA: 11:44 - loss: 0.2247 - acc: 0.9112
# 727/792 [==========================>...] - ETA: 11:34 - loss: 0.2245 - acc: 0.9113
# 728/792 [==========================>...] - ETA: 11:23 - loss: 0.2244 - acc: 0.9114
# 729/792 [==========================>...] - ETA: 11:12 - loss: 0.2242 - acc: 0.9115
# 730/792 [==========================>...] - ETA: 11:02 - loss: 0.2241 - acc: 0.9115
# 731/792 [==========================>...] - ETA: 10:51 - loss: 0.2238 - acc: 0.9116
# 732/792 [==========================>...] - ETA: 10:40 - loss: 0.2238 - acc: 0.9116
# 733/792 [==========================>...] - ETA: 10:30 - loss: 0.2237 - acc: 0.9116
# 734/792 [==========================>...] - ETA: 10:19 - loss: 0.2234 - acc: 0.9117
# 735/792 [==========================>...] - ETA: 10:08 - loss: 0.2234 - acc: 0.9117
# 736/792 [==========================>...] - ETA: 9:58 - loss: 0.2233 - acc: 0.9118 
# 737/792 [==========================>...] - ETA: 9:47 - loss: 0.2233 - acc: 0.9117
# 738/792 [==========================>...] - ETA: 9:36 - loss: 0.2233 - acc: 0.9117
# 739/792 [==========================>...] - ETA: 9:26 - loss: 0.2234 - acc: 0.9116
# 740/792 [===========================>..] - ETA: 9:15 - loss: 0.2233 - acc: 0.9117
# 741/792 [===========================>..] - ETA: 9:04 - loss: 0.2233 - acc: 0.9118
# 742/792 [===========================>..] - ETA: 8:54 - loss: 0.2231 - acc: 0.9119
# 743/792 [===========================>..] - ETA: 8:43 - loss: 0.2228 - acc: 0.9120
# 744/792 [===========================>..] - ETA: 8:32 - loss: 0.2227 - acc: 0.9120
# 745/792 [===========================>..] - ETA: 8:22 - loss: 0.2225 - acc: 0.9121
# 746/792 [===========================>..] - ETA: 8:11 - loss: 0.2225 - acc: 0.9120
# 747/792 [===========================>..] - ETA: 8:00 - loss: 0.2226 - acc: 0.9120
# 748/792 [===========================>..] - ETA: 7:50 - loss: 0.2223 - acc: 0.9121
# 749/792 [===========================>..] - ETA: 7:39 - loss: 0.2222 - acc: 0.9122
# 750/792 [===========================>..] - ETA: 7:28 - loss: 0.2221 - acc: 0.9122
# 751/792 [===========================>..] - ETA: 7:18 - loss: 0.2219 - acc: 0.9123
# 752/792 [===========================>..] - ETA: 7:07 - loss: 0.2216 - acc: 0.9124
# 753/792 [===========================>..] - ETA: 6:56 - loss: 0.2214 - acc: 0.9125
# 754/792 [===========================>..] - ETA: 6:45 - loss: 0.2212 - acc: 0.9126
# 755/792 [===========================>..] - ETA: 6:35 - loss: 0.2212 - acc: 0.9126
# 756/792 [===========================>..] - ETA: 6:24 - loss: 0.2212 - acc: 0.9125
# 757/792 [===========================>..] - ETA: 6:13 - loss: 0.2213 - acc: 0.9124
# 758/792 [===========================>..] - ETA: 6:03 - loss: 0.2210 - acc: 0.9125
# 759/792 [===========================>..] - ETA: 5:52 - loss: 0.2212 - acc: 0.9124
# 760/792 [===========================>..] - ETA: 5:41 - loss: 0.2212 - acc: 0.9124
# 761/792 [===========================>..] - ETA: 5:31 - loss: 0.2210 - acc: 0.9125
# 762/792 [===========================>..] - ETA: 5:20 - loss: 0.2209 - acc: 0.9125
# 763/792 [===========================>..] - ETA: 5:09 - loss: 0.2211 - acc: 0.9125
# 764/792 [===========================>..] - ETA: 4:59 - loss: 0.2213 - acc: 0.9124
# 765/792 [===========================>..] - ETA: 4:48 - loss: 0.2211 - acc: 0.9125
# 766/792 [============================>.] - ETA: 4:37 - loss: 0.2216 - acc: 0.9124
# 767/792 [============================>.] - ETA: 4:27 - loss: 0.2213 - acc: 0.9125
# 768/792 [============================>.] - ETA: 4:16 - loss: 0.2214 - acc: 0.9125
# 769/792 [============================>.] - ETA: 4:05 - loss: 0.2212 - acc: 0.9126
# 770/792 [============================>.] - ETA: 3:55 - loss: 0.2211 - acc: 0.9127
# 771/792 [============================>.] - ETA: 3:44 - loss: 0.2209 - acc: 0.9127
# 772/792 [============================>.] - ETA: 3:33 - loss: 0.2208 - acc: 0.9128
# 773/792 [============================>.] - ETA: 3:22 - loss: 0.2206 - acc: 0.9128
# 774/792 [============================>.] - ETA: 3:12 - loss: 0.2205 - acc: 0.9130
# 775/792 [============================>.] - ETA: 3:01 - loss: 0.2205 - acc: 0.9129
# 776/792 [============================>.] - ETA: 2:50 - loss: 0.2204 - acc: 0.9130
# 777/792 [============================>.] - ETA: 2:40 - loss: 0.2205 - acc: 0.9130
# 778/792 [============================>.] - ETA: 2:29 - loss: 0.2203 - acc: 0.9130
# 779/792 [============================>.] - ETA: 2:18 - loss: 0.2202 - acc: 0.9131
# 780/792 [============================>.] - ETA: 2:08 - loss: 0.2200 - acc: 0.9131
# 781/792 [============================>.] - ETA: 1:57 - loss: 0.2199 - acc: 0.9131
# 782/792 [============================>.] - ETA: 1:46 - loss: 0.2197 - acc: 0.9132
# 783/792 [============================>.] - ETA: 1:36 - loss: 0.2196 - acc: 0.9133
# 784/792 [============================>.] - ETA: 1:25 - loss: 0.2195 - acc: 0.9133
# 785/792 [============================>.] - ETA: 1:14 - loss: 0.2196 - acc: 0.9132
# 786/792 [============================>.] - ETA: 1:04 - loss: 0.2195 - acc: 0.9133
# 787/792 [============================>.] - ETA: 53s - loss: 0.2194 - acc: 0.9133 
# 788/792 [============================>.] - ETA: 42s - loss: 0.2192 - acc: 0.9134
# 789/792 [============================>.] - ETA: 32s - loss: 0.2190 - acc: 0.9136
# 790/792 [============================>.] - ETA: 21s - loss: 0.2191 - acc: 0.9135
# 791/792 [============================>.] - ETA: 10s - loss: 0.2189 - acc: 0.9136
# 792/792 [==============================] - 8767s 11s/step - loss: 0.2194 - acc: 0.9134 - val_loss: 0.1507 - val_acc: 0.9413
# 总耗时：8787.115825176239
#
# Process finished with exit code 0
